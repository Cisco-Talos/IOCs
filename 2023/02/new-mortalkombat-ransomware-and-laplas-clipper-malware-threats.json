{"type": "bundle", "spec_version": "2.0", "id": "bundle--76dd0719-9dde-4e74-a346-b87444f09746", "objects": [{"type": "identity", "id": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Talos", "identity_class": "organization"}, {"type": "report", "id": "report--f34c7564-64f2-4e3f-9e1d-099c6680ffb8", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Threat Spotlight: New MortalKombat ransomware and Laplas Clipper malware threats deployed in financially motivated campaign", "published": "2023-02-14T07:17:46Z", "object_refs": ["x-misp-attribute--891023b3-e242-4df6-872a-b610011bf380", "observed-data--1835f544-b9f3-4f50-922b-8c98874af12b", "indicator--93554db2-0958-4ef3-91ea-ead08c45ea38", "indicator--7d4cceeb-27ea-4174-abec-63bc4d76317e", "indicator--42bf5214-8478-4f7c-ba32-22c90f2960ae", "indicator--a00e51ba-6767-4f8c-be54-804d9c9ffb33", "indicator--4391ab5c-6f2c-4e50-90dc-0485c0293ff4", "indicator--0d29e888-ecf4-45dc-993d-6a83264763cd", "indicator--38e8b632-1e7a-4aa9-b3a6-dc2605485cd8", "indicator--7e5d045c-0501-4ad7-a594-eaea09cc70b7", "indicator--cd542b9a-441c-4735-8dd8-75893838b465", "indicator--d200a004-bb2e-4094-b3a9-45503d51c82b", "indicator--c2e668e4-7350-4f08-9311-31ac256eaf8b", "indicator--b32c1718-4c71-433e-bb1d-41d0f9397695", "indicator--9609158b-7b64-429d-ba69-12f97b8a4d62", "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830", "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44", "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670", "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7", "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279", "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "attack-pattern--e2ea7f6b-8d4f-49c3-819d-660530d12b77", "attack-pattern--cf28ca46-1fd3-46b4-b1f6-ec0b72361848", "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896", "attack-pattern--348f1eef-964b-4eb6-bb53-69b3dcb0c643", "attack-pattern--8e350c1d-ac79-4b5c-bd4e-7476d7e84ec5", "attack-pattern--e3b936a4-6321-4172-9114-038a866362ec"], "labels": ["Threat-Report", "misp:tool=\"MISP-STIX-Converter\"", " Ransomware", " TLP:WHITE", "LaplasClipper", "Talos_Intel_Blog"]}, {"type": "x-misp-attribute", "id": "x-misp-attribute--891023b3-e242-4df6-872a-b610011bf380", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:08:15.000Z", "modified": "2023-02-14T07:08:15.000Z", "labels": ["misp:type=\"text\"", "misp:category=\"Payload type\""], "x_misp_category": "Payload type", "x_misp_type": "text", "x_misp_value": "GO Laplas Clipper\r\nMortalKombat Ransomware"}, {"type": "observed-data", "id": "observed-data--1835f544-b9f3-4f50-922b-8c98874af12b", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:10:00.000Z", "modified": "2023-02-14T07:10:00.000Z", "first_observed": "2023-02-14T07:10:00Z", "last_observed": "2023-02-14T07:10:00Z", "number_observed": 1, "objects": {"0": {"type": "url", "value": "https://blog.talosintelligence.com/new-mortalkombat-ransomware-and-laplas-clipper-malware-threats"}}, "labels": ["misp:type=\"url\"", "misp:category=\"External analysis\""]}, {"type": "indicator", "id": "indicator--93554db2-0958-4ef3-91ea-ead08c45ea38", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:18.000Z", "modified": "2023-02-14T07:14:18.000Z", "pattern": "[network-traffic:dst_ref.type = 'ipv4-addr' AND network-traffic:dst_ref.value = '193.169.255.78']", "valid_from": "2023-02-14T07:14:18Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"ip-dst\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--7d4cceeb-27ea-4174-abec-63bc4d76317e", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:18.000Z", "modified": "2023-02-14T07:14:18.000Z", "pattern": "[network-traffic:dst_ref.type = 'ipv4-addr' AND network-traffic:dst_ref.value = '144.76.136.153']", "valid_from": "2023-02-14T07:14:18Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"ip-dst\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--42bf5214-8478-4f7c-ba32-22c90f2960ae", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[domain-name:value = 'clipper.guru']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--a00e51ba-6767-4f8c-be54-804d9c9ffb33", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[domain-name:value = 'transfer.sh']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--4391ab5c-6f2c-4e50-90dc-0485c0293ff4", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "description": "Ransom note: Victim communication email ID", "pattern": "[email-message:from_ref.value = 'hack3dlikeapro@proton.me']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"email-src\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--0d29e888-ecf4-45dc-993d-6a83264763cd", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[url:value = 'http://193.169.255.78/fw-apgksdtpx4hoaujjmbvdnxpohz.pdf.zip']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"url\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--38e8b632-1e7a-4aa9-b3a6-dc2605485cd8", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[url:value = 'http://193.169.255.78/fw-cpgk2xfpx4hoaujjmbvdnxpohz.pdf.zip']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"url\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--7e5d045c-0501-4ad7-a594-eaea09cc70b7", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[file:hashes.SHA256 = '9a5a5d50dea40645697fabc8168cc32faf8e71ca77a2ea3f5f73d1b9a57fc7b0']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--cd542b9a-441c-4735-8dd8-75893838b465", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[file:hashes.SHA256 = '26d870d277e2eca955e51a8ea77d942ebafbbf3cbf29371a04a43cfe1546db17']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--d200a004-bb2e-4094-b3a9-45503d51c82b", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[file:hashes.SHA256 = '1bf30c5c51a3533b4f0d7d3d560df691657d62374441d772f563376b55a60818']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--c2e668e4-7350-4f08-9311-31ac256eaf8b", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[file:hashes.SHA256 = 'f02512e7e2950bdf5fa0cd6fa6b097f806e1b0f6a25538d3314c793998484220']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--b32c1718-4c71-433e-bb1d-41d0f9397695", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[file:hashes.SHA256 = '63ec10e267a71885089fe6de698d2730c5c7bc6541f40370680b86ab4581a47d']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--9609158b-7b64-429d-ba69-12f97b8a4d62", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-02-14T07:14:19.000Z", "modified": "2023-02-14T07:14:19.000Z", "pattern": "[file:hashes.SHA256 = 'e5f60df786e9da9850b7f01480ebffced3be396618c230fa94b5cbc846723553']", "valid_from": "2023-02-14T07:14:19Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "attack-pattern", "id": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Command-Line Interface - T1059", "description": "ATT&CK Tactic | Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is [cmd](https://attack.mitre.org/software/S0106), which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. [Scheduled Task](https://attack.mitre.org/techniques/T1053)).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Command-Line Interface - T1059\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1059"}]}, {"type": "attack-pattern", "id": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Scripting - T1064", "description": "ATT&CK Tactic | **This technique has been deprecated. Please use [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) where appropriate.**\n\nAdversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Scripting - T1064\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1064"}]}, {"type": "attack-pattern", "id": "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Execution through API - T1106", "description": "ATT&CK Tactic | Adversary tools may directly use the Windows application programming interface (API) to execute binaries. Functions such as the Windows API CreateProcess will allow programs and scripts to start other processes with proper path and argument parameters. (Citation: Microsoft CreateProcess)\n\nAdditional Windows API calls that can be used to execute binaries include: (Citation: Kanthak Verifier)\n\n* CreateProcessA() and CreateProcessW(),\n* CreateProcessAsUserA() and CreateProcessAsUserW(),\n* CreateProcessInternalA() and CreateProcessInternalW(),\n* CreateProcessWithLogonW(), CreateProcessWithTokenW(),\n* LoadLibraryA() and LoadLibraryW(),\n* LoadLibraryExA() and LoadLibraryExW(),\n* LoadModule(),\n* LoadPackagedLibrary(),\n* WinExec(),\n* ShellExecuteA() and ShellExecuteW(),\n* ShellExecuteExA() and ShellExecuteExW()", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Execution through API - T1106\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1106"}]}, {"type": "attack-pattern", "id": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "BITS Jobs - T1197", "description": "ATT&CK Tactic | Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads. Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM).(Citation: Microsoft COM)(Citation: Microsoft BITS) BITS is commonly used by updaters, messengers, and other applications preferred to operate in the background (using available idle bandwidth) without interrupting other networked applications. File transfer tasks are implemented as BITS jobs, which contain a queue of one or more file operations.\n\nThe interface to create and manage BITS jobs is accessible through [PowerShell](https://attack.mitre.org/techniques/T1059/001) and the [BITSAdmin](https://attack.mitre.org/software/S0190) tool.(Citation: Microsoft BITS)(Citation: Microsoft BITSAdmin)\n\nAdversaries may abuse BITS to download, execute, and even clean up after running malicious code. BITS tasks are self-contained in the BITS job database, without new files or registry modifications, and often permitted by host firewalls.(Citation: CTU BITS Malware June 2016)(Citation: Mondok Windows PiggyBack BITS May 2007)(Citation: Symantec BITS May 2007) BITS enabled execution may also enable persistence by creating long-standing jobs (the default maximum lifetime is 90 days and extendable) or invoking an arbitrary program when a job completes or errors (including after system reboots).(Citation: PaloAlto UBoatRAT Nov 2017)(Citation: CTU BITS Malware June 2016)\n\nBITS upload functionalities can also be used to perform [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).(Citation: CTU BITS Malware June 2016)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"BITS Jobs - T1197\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1197"}]}, {"type": "attack-pattern", "id": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Registry Run Keys / Startup Folder - T1547.001", "description": "ATT&CK Tactic | Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.(Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nPlacing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\\Users\\\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</code>. The startup folder path for all users is <code>C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp</code>.\n\nThe following run keys are created by default on Windows systems:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nRun keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.(Citation: Microsoft Run Key) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Registry Run Keys / Startup Folder - T1547.001\""], "external_references": [{"source_name": "capec", "external_id": "CAPEC-270"}]}, {"type": "attack-pattern", "id": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Modify Registry - T1112", "description": "ATT&CK Tactic | Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\n\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\n\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\n\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Modify Registry - T1112\""], "external_references": [{"source_name": "capec", "external_id": "CAPEC-203"}]}, {"type": "attack-pattern", "id": "attack-pattern--e2ea7f6b-8d4f-49c3-819d-660530d12b77", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "System Information Discovery - T1426", "description": "ATT&CK Tactic | An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, and architecture.\n\nOn Android, much of this information is programmatically accessible to applications through the android.os.Build class.(Citation: Android-Build)\n\nOn iOS, techniques exist for applications to programmatically access this information.(Citation: StackOverflow-iOSVersion)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"System Information Discovery - T1426\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1426"}]}, {"type": "attack-pattern", "id": "attack-pattern--cf28ca46-1fd3-46b4-b1f6-ec0b72361848", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "File and Directory Discovery - T1420", "description": "ATT&CK Tactic | On Android, command line tools or the Java file APIs can be used to enumerate file system contents. However, Linux file permissions and SELinux policies generally strongly restrict what can be accessed by apps (without taking advantage of a privilege escalation exploit). The contents of the external storage directory are generally visible, which could present concern if sensitive data is inappropriately stored there.\n\niOS's security architecture generally restricts the ability to perform file and directory discovery without use of escalated privileges.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"File and Directory Discovery - T1420\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1420"}]}, {"type": "attack-pattern", "id": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Query Registry - T1012", "description": "ATT&CK Tactic | Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.\n\nThe Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Query Registry - T1012\""], "external_references": [{"source_name": "capec", "external_id": "CAPEC-647"}]}, {"type": "attack-pattern", "id": "attack-pattern--348f1eef-964b-4eb6-bb53-69b3dcb0c643", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Peripheral Device Discovery - T1120", "description": "ATT&CK Tactic | Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.(Citation: Peripheral Discovery Linux)(Citation: Peripheral Discovery macOS) Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Peripheral Device Discovery - T1120\""], "external_references": [{"source_name": "capec", "external_id": "CAPEC-646"}]}, {"type": "attack-pattern", "id": "attack-pattern--8e350c1d-ac79-4b5c-bd4e-7476d7e84ec5", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol - T1048.002", "description": "ATT&CK Tactic | Adversaries may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. \n\nAsymmetric encryption algorithms are those that use different keys on each end of the channel. Also known as public-key cryptography, this requires pairs of cryptographic keys that can encrypt/decrypt data from the corresponding key. Each end of the communication channels requires a private key (only in the procession of that entity) and the public key of the other entity. The public keys of each entity are exchanged before encrypted communications begin. \n\nNetwork protocols that use asymmetric encryption (such as HTTPS/TLS/SSL) often utilize symmetric encryption once keys are exchanged. Adversaries may opt to use these encrypted mechanisms that are baked into a protocol. ", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol - T1048.002\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1048.002"}]}, {"type": "attack-pattern", "id": "attack-pattern--e3b936a4-6321-4172-9114-038a866362ec", "created": "2023-02-14T07:17:46.000Z", "modified": "2023-02-14T07:17:46.000Z", "name": "Data Encrypted - T1532", "description": "ATT&CK Tactic | Data is encrypted before being exfiltrated in order to hide the information that is being exfiltrated from detection or to make the exfiltration less conspicuous upon inspection by a defender. The encryption is performed by a utility, programming library, or custom algorithm on the data itself and is considered separate from any encryption performed by the command and control or file transfer protocol. Common file formats that can encrypt files are RAR and zip.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Data Encrypted - T1532\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1532"}]}]}
