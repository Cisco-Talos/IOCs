CVE-2023-23397: if 
(
    (attachment-size < 102400) 
    AND 
    (recv-listener == "IncomingMail")
) 
AND
(
    (
        (
            (attachment-binary-contains("^\\xD0\\xCF\\x11\\xE0\\xA1\\xB1\\x1A\\xE1")) 
            AND 
            (attachment-binary-contains("\\x0B\\x0D\\x02\\x00\\x00\\x00\\x00\\x00\\xC0\\x00\\x00\\x00\\x00\\x00\\x00\\x46"))
        ) 
        OR 
        (attachment-binary-contains("^\\x78\\x9F\\x3E\\x22"))      
    ) 
    AND 
    (
        (attachment-binary-contains("\\x1F\\x85\\x00\\x00")) 
        AND 
        (attachment-binary-contains("\\x00\\x00\\x5C(\\x00)?\\x5C(\\x00)?"))
    ) 
)
{
    log-entry("CVE-2023-23397: Found CLSID in OLE or TNEF.");
    log-entry("CVE-2023-23397: Found PidLidReminderFileParameter and UNC path indicators");
    insert-header("X-CVE-2023-23397", "True");
    strip-header("Subject");
    insert-header("Subject", "*** WARNING: Highly Suspicious Attachment *** $Subject");
    # Comment/Uncomment to Quarantine the message 
    quarantine("Policy");
}
. 
