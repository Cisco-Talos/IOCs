{"type": "bundle", "spec_version": "2.0", "id": "bundle--31375a12-b2aa-4afb-816e-ed4749c6d063", "objects": [{"type": "identity", "id": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Talos", "identity_class": "organization"}, {"type": "report", "id": "report--f5c71a54-3b35-44d3-86e4-f63e918f8cde", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Emotet Resumes Spam Operations, Switches to OneNote", "published": "2023-03-22T19:07:48Z", "object_refs": ["observed-data--db2919d5-27a1-43f0-9692-c619445e2251", "x-misp-attribute--5f712755-d73c-4600-9165-fa2665812cda", "x-misp-attribute--ca3fe553-0ebd-4821-893f-6585e73e5701", "indicator--af8234c5-fc93-4372-87ab-3ee202a5c49b", "indicator--a2d7a6f5-8862-448f-900d-e1003084ace1", "indicator--d256b78a-df84-44ed-8150-d4a5f74b53eb", "indicator--017e313b-1464-4845-823e-50ce73f0d956", "indicator--b2ff1025-9f5d-42b4-b3da-652b9eb38c65", "indicator--e6bce603-ec96-472f-ada4-a620c24430b8", "indicator--6511cb89-aeb5-4829-aa39-825b2f3066a2", "indicator--4bbac7ba-962e-4b7f-8310-7f74db4385b9", "indicator--afee263f-6542-46a2-b485-3e9d38ef2a5d", "indicator--d3b89476-6658-45b3-a238-1d41450fe47d", "indicator--0549e320-8dd3-48c6-aac6-6f9bef8f8efe", "indicator--28ce99b0-78ff-4663-9db8-63d251575bb1", "indicator--bdd77feb-7ced-4405-b54f-72eb51f46319", "indicator--3d9b128d-6c88-4050-8cdf-ee0292e85e04", "indicator--64fad7e8-a805-4f3f-a6ba-271523c339c6", "indicator--76d5cccb-ed56-494c-9fd5-5eb4217869a6", "indicator--0d1af98f-6429-4bd1-b161-1e6fe6d9a760", "indicator--1fac4ec0-ce3f-423d-bbad-b3bde4cd9703", "indicator--9ecba325-94cd-4e6a-bf26-85657d3ebd1a", "indicator--cc37a56f-4a36-4f1c-8deb-866f8136dad7", "malware--32066e94-3112-48ca-b9eb-ba2b59d2f023", "threat-actor--c93281be-f6cd-4cd0-a5a3-defde9d77d8b", "attack-pattern--edbe24e9-aec4-4994-ac75-6a6bc7f1ddd0", "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4", "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670", "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e", "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "attack-pattern--7e7c2fba-7cca-486c-9582-4c1bb2851961", "attack-pattern--241814ae-de3f-4656-b49e-f9a80764d4b7", "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279", "attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62", "attack-pattern--2959d63f-73fd-46a1-abd2-109d7dcede32", "attack-pattern--d13fa042-8f26-44e1-a2a8-af0bf8e2ac9a", "attack-pattern--e4dc8c01-417f-458d-9ee0-bb0617c1b391"], "labels": ["Threat-Report", "misp:tool=\"MISP-STIX-Converter\"", "Talos_Intel_Blog"], "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}, {"type": "observed-data", "id": "observed-data--db2919d5-27a1-43f0-9692-c619445e2251", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:37:30.000Z", "modified": "2023-03-22T18:37:30.000Z", "first_observed": "2023-03-22T18:37:30Z", "last_observed": "2023-03-22T18:37:30Z", "number_observed": 1, "objects": {"0": {"type": "url", "value": "https://blog.talosintelligence.com/emotet-switches-to-onenote/"}}, "labels": ["misp:type=\"url\"", "misp:category=\"External analysis\""]}, {"type": "x-misp-attribute", "id": "x-misp-attribute--5f712755-d73c-4600-9165-fa2665812cda", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:37:55.000Z", "modified": "2023-03-22T18:37:55.000Z", "labels": ["misp:type=\"threat-actor\"", "misp:category=\"Attribution\""], "x_misp_category": "Attribution", "x_misp_type": "threat-actor", "x_misp_value": "MUMMY SPIDER"}, {"type": "x-misp-attribute", "id": "x-misp-attribute--ca3fe553-0ebd-4821-893f-6585e73e5701", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:38:15.000Z", "modified": "2023-03-22T18:38:15.000Z", "labels": ["misp:type=\"text\"", "misp:category=\"Payload type\""], "x_misp_category": "Payload type", "x_misp_type": "text", "x_misp_value": "Emotet"}, {"type": "indicator", "id": "indicator--af8234c5-fc93-4372-87ab-3ee202a5c49b", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '4d9a6dfca804989d40eeca9bb2d90ef33f3980eb07ca89bbba06d0ef4b37634b']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--a2d7a6f5-8862-448f-900d-e1003084ace1", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '51f1fdf15170d27b6c36e52407bc57e614400179e93fb406eb8e8d6a1d3ecfa7']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--d256b78a-df84-44ed-8150-d4a5f74b53eb", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '3b4fad0f7faeaa5d64daa9188a67b0de49f8909321e969c086204414652795ff']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--017e313b-1464-4845-823e-50ce73f0d956", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '2e116e6a43dcc2ee55df34664a7d5bfae36918f3a8ce5af97be6cb99e3a4de5b']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--b2ff1025-9f5d-42b4-b3da-652b9eb38c65", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '745a064f8faeb470661c5277e7de8a282eb784d55dea0f8530e502732be8ee46']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--e6bce603-ec96-472f-ada4-a620c24430b8", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '5697f2ac10e6f1a82497b6b8b19df905f77980ed0644ccd93d2e7bdbfd912241']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--6511cb89-aeb5-4829-aa39-825b2f3066a2", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = 'e173ecebfd5b01766dd8184250d5f2d442507b9b097e4ced319c246b78550d85']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--4bbac7ba-962e-4b7f-8310-7f74db4385b9", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = 'b75681c1f99c4caf541478cc417ee9e8fba48f9b902c45d8bda0158a61ba1a2f']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--afee263f-6542-46a2-b485-3e9d38ef2a5d", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = 'a43e0864905fe7afd6d8dbf26bd27d898a2effd386e81cfbc08cae9cf94ed968']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--d3b89476-6658-45b3-a238-1d41450fe47d", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'ozmeydan.com']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--0549e320-8dd3-48c6-aac6-6f9bef8f8efe", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'softwareulike.com']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--28ce99b0-78ff-4663-9db8-63d251575bb1", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'wrappixels.com']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--bdd77feb-7ced-4405-b54f-72eb51f46319", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[network-traffic:dst_ref.type = 'ipv4-addr' AND network-traffic:dst_ref.value = '139.219.4.166']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"ip-dst\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--3d9b128d-6c88-4050-8cdf-ee0292e85e04", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'www.snaptikt.com']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"hostname\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--64fad7e8-a805-4f3f-a6ba-271523c339c6", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'diasgallery.com']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--76d5cccb-ed56-494c-9fd5-5eb4217869a6", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'midcoastsupplies.com.au']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"hostname\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--0d1af98f-6429-4bd1-b161-1e6fe6d9a760", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'mtp.evotek.vn']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"hostname\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--1fac4ec0-ce3f-423d-bbad-b3bde4cd9703", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'www.189dom.com']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"hostname\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--9ecba325-94cd-4e6a-bf26-85657d3ebd1a", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[domain-name:value = 'esentai-gourmet.kz']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Network activity"}], "labels": ["misp:type=\"domain\"", "misp:category=\"Network activity\"", "misp:to_ids=\"True\""]}, {"type": "indicator", "id": "indicator--cc37a56f-4a36-4f1c-8deb-866f8136dad7", "created_by_ref": "identity--5df15c12-89fc-45a7-9620-0044ac110004", "created": "2023-03-22T18:40:23.000Z", "modified": "2023-03-22T18:40:23.000Z", "pattern": "[file:hashes.SHA256 = '2f39c2879989ddd7f9ecf52b6232598e5595f8bf367846ff188c9dfbf1251253']", "valid_from": "2023-03-22T18:40:23Z", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "Payload delivery"}], "labels": ["misp:type=\"sha256\"", "misp:category=\"Payload delivery\"", "misp:to_ids=\"True\""]}, {"type": "malware", "id": "malware--32066e94-3112-48ca-b9eb-ba2b59d2f023", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Emotet - S0367", "description": "Name of ATT&CK software | [Emotet](https://attack.mitre.org/software/S0367) is a modular malware variant which is primarily used as a downloader for other malware variants such as [TrickBot](https://attack.mitre.org/software/S0266) and [IcedID](https://attack.mitre.org/software/S0483). Emotet first emerged in June 2014 and has been primarily used to target the banking sector. (Citation: Trend Micro Banking Malware Jan 2019)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-malware"}], "labels": ["misp:galaxy-name=\"Malware\"", "misp:galaxy-type=\"mitre-malware\"", "misp-galaxy:mitre-malware=\"Emotet - S0367\""], "external_references": [{"source_name": "mitre-attack", "external_id": "S0367"}]}, {"type": "threat-actor", "id": "threat-actor--c93281be-f6cd-4cd0-a5a3-defde9d77d8b", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "MUMMY SPIDER", "description": "Threat actors are characteristics of malicious actors (or adversaries) representing a cyber attack threat including presumed intent and historically observed behaviour. | MUMMY SPIDER is a criminal entity linked to the core development of the malware most commonly known as Emotet or Geodo. First observed in mid-2014, this malware shared code with the Bugat (aka Feodo) banking Trojan. However, MUMMY SPIDER swiftly developed the malware\u2019s capabilities to include an RSA key exchange for command and control (C2) communication and a modular architecture.\nMUMMY SPIDER does not follow typical criminal behavioral patterns. In particular, MUMMY SPIDER usually conducts attacks for a few months before ceasing operations for a period of between three and 12 months, before returning with a new variant or version.\nAfter a 10 month hiatus, MUMMY SPIDER returned Emotet to operation in December 2016 but the latest variant is not deploying a banking Trojan module with web injects, it is currently acting as a \u2018loader\u2019 delivering other malware packages. The primary modules perform reconnaissance on victim machines, drop freeware tools for credential collection from web browsers and mail clients and a spam plugin for self-propagation. The malware is also issuing commands to download and execute other malware families such as the banking Trojans Dridex and Qakbot.\n MUMMY SPIDER advertised Emotet on underground forums until 2015, at which time it became private. Therefore, it is highly likely that Emotet is operate", "aliases": ["TA542", "GOLD CRESTWOOD"], "labels": ["misp:galaxy-name=\"Threat Actor\"", "misp:galaxy-type=\"threat-actor\"", "misp-galaxy:threat-actor=\"MUMMY SPIDER\""]}, {"type": "attack-pattern", "id": "attack-pattern--edbe24e9-aec4-4994-ac75-6a6bc7f1ddd0", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Dynamic Data Exchange - T1173", "description": "ATT&CK Tactic | Windows Dynamic Data Exchange (DDE) is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution.\n\nObject Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by COM, DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys. (Citation: BleepingComputer DDE Disabled in Word Dec 2017) (Citation: Microsoft ADV170021 Dec 2017) (Citation: Microsoft DDE Advisory Nov 2017)\n\nAdversaries may use DDE to execute arbitrary commands. Microsoft Office documents can be poisoned with DDE commands (Citation: SensePost PS DDE May 2016) (Citation: Kettle CSV DDE Aug 2014), directly or through embedded files (Citation: Enigma Reviving DDE Jan 2018), and used to deliver execution via phishing campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros. (Citation: SensePost MacroLess DDE Oct 2017) DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to command line execution.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Dynamic Data Exchange - T1173\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1173"}]}, {"type": "attack-pattern", "id": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "System Binary Proxy Execution - T1218", "description": "ATT&CK Tactic | Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed, or otherwise trusted, binaries. Binaries used in this technique are often Microsoft-signed files, indicating that they have been either downloaded from Microsoft or are already native in the operating system.(Citation: LOLBAS Project) Binaries signed with trusted digital certificates can typically execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files or commands.\n\nSimilarly, on Linux systems adversaries may abuse trusted binaries such as <code>split</code> to proxy execution of malicious commands.(Citation: split man page)(Citation: GTFO split)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"System Binary Proxy Execution - T1218\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1218"}]}, {"type": "attack-pattern", "id": "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Native API - T1106", "description": "ATT&CK Tactic | Adversaries may interact with the native OS application programming interface (API) to execute behaviors. Native APIs provide a controlled means of calling low-level OS services within the kernel, such as those involving hardware/devices, memory, and processes.(Citation: NT API Windows)(Citation: Linux Kernel API) These native APIs are leveraged by the OS during system boot (when other system components are not yet initialized) as well as carrying out tasks and requests during routine operations.\n\nNative API functions (such as <code>NtCreateProcess</code>) may be directed invoked via system calls / syscalls, but these features are also often exposed to user-mode applications via interfaces and libraries.(Citation: OutFlank System Calls)(Citation: CyberBit System Calls)(Citation: MDSec System Calls) For example, functions such as the Windows API <code>CreateProcess()</code> or GNU <code>fork()</code> will allow programs and scripts to start other processes.(Citation: Microsoft CreateProcess)(Citation: GNU Fork) This may allow API callers to execute a binary, run a CLI command, load modules, etc. as thousands of similar API functions exist for various system operations.(Citation: Microsoft Win32)(Citation: LIBC)(Citation: GLIBC)\n\nHigher level software frameworks, such as Microsoft .NET and macOS Cocoa, are also available to interact with native APIs. These frameworks typically provide language wrappers/abstractions to API functionalities and are designed for ease-of-use/portability of code.(Citation: Microsoft NET)(Citation: Apple Core Services)(Citation: MACOS Cocoa)(Citation: macOS Foundation)\n\nAdversaries may abuse these OS API functions as a means of executing behaviors. Similar to [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), the native API and its hierarchy of interfaces provide mechanisms to interact with and utilize various components of a victimized system. While invoking API functions, adversaries may also attempt to bypass defensive tools (ex: unhooking monitored functions via [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001)).", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Native API - T1106\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1106"}]}, {"type": "attack-pattern", "id": "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Indirect Command Execution - T1202", "description": "ATT&CK Tactic | Adversaries may abuse utilities that allow for command execution to bypass security restrictions that limit the use of command-line interpreters. Various Windows utilities may be used to execute commands, possibly without invoking [cmd](https://attack.mitre.org/software/S0106). For example, [Forfiles](https://attack.mitre.org/software/S0193), the Program Compatibility Assistant (pcalua.exe), components of the Windows Subsystem for Linux (WSL), as well as other utilities may invoke the execution of programs and commands from a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), Run window, or via scripts. (Citation: VectorSec ForFiles Aug 2017) (Citation: Evi1cg Forfiles Nov 2017)\n\nAdversaries may abuse these features for [Defense Evasion](https://attack.mitre.org/tactics/TA0005), specifically to perform arbitrary execution while subverting detections and/or mitigation controls (such as Group Policy) that limit/prevent the usage of [cmd](https://attack.mitre.org/software/S0106) or file extensions more commonly associated with malicious payloads.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Indirect Command Execution - T1202\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1202"}]}, {"type": "attack-pattern", "id": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Ingress Tool Transfer - T1105", "description": "ATT&CK Tactic | Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as [ftp](https://attack.mitre.org/software/S0095). Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)). \n\nFiles can also be transferred using various [Web Service](https://attack.mitre.org/techniques/T1102)s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016)\n\nOn Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, and [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands such as <code>IEX(New-Object Net.WebClient).downloadString()</code> and <code>Invoke-WebRequest</code>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Ingress Tool Transfer - T1105\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1105"}]}, {"type": "attack-pattern", "id": "attack-pattern--7e7c2fba-7cca-486c-9582-4c1bb2851961", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Mark-of-the-Web Bypass - T1553.005", "description": "ATT&CK Tactic | Adversaries may abuse specific file formats to subvert Mark-of-the-Web (MOTW) controls. In Windows, when files are downloaded from the Internet, they are tagged with a hidden NTFS Alternate Data Stream (ADS) named <code>Zone.Identifier</code> with a specific value known as the MOTW.(Citation: Microsoft Zone.Identifier 2020) Files that are tagged with MOTW are protected and cannot perform certain actions. For example, starting in MS Office 10, if a MS Office file has the MOTW, it will open in Protected View. Executables tagged with the MOTW will be processed by Windows Defender SmartScreen that compares files with an allowlist of well-known executables. If the file in not known/trusted, SmartScreen will prevent the execution and warn the user not to run it.(Citation: Beek Use of VHD Dec 2020)(Citation: Outflank MotW 2020)(Citation: Intezer Russian APT Dec 2020)\n\nAdversaries may abuse container files such as compressed/archive (.arj, .gzip) and/or disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW. Container files downloaded from the Internet will be marked with MOTW but the files within may not inherit the MOTW after the container files are extracted and/or mounted. MOTW is a NTFS feature and many container files do not support NTFS alternative data streams. After a container file is extracted and/or mounted, the files contained within them may be treated as local files on disk and run without protections.(Citation: Beek Use of VHD Dec 2020)(Citation: Outflank MotW 2020)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Mark-of-the-Web Bypass - T1553.005\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1553.005"}]}, {"type": "attack-pattern", "id": "attack-pattern--241814ae-de3f-4656-b49e-f9a80764d4b7", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Security Software Discovery - T1063", "description": "ATT&CK Tactic | Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on the system. This may include things such as local firewall rules and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1063) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n\n### Windows\n\nExample commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for.\n\n### Mac\n\nIt's becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Security Software Discovery - T1063\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1063"}]}, {"type": "attack-pattern", "id": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Registry Run Keys / Startup Folder - T1547.001", "description": "ATT&CK Tactic | Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.(Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nPlacing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\\Users\\\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</code>. The startup folder path for all users is <code>C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp</code>.\n\nThe following run keys are created by default on Windows systems:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nRun keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.(Citation: Microsoft Run Key) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Registry Run Keys / Startup Folder - T1547.001\""], "external_references": [{"source_name": "capec", "external_id": "CAPEC-270"}]}, {"type": "attack-pattern", "id": "attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Windows Command Shell - T1059.003", "description": "ATT&CK Tactic | Adversaries may abuse the Windows command shell for execution. The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH in Windows)\n\nBatch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.\n\nAdversaries may leverage [cmd](https://attack.mitre.org/software/S0106) to execute various commands and payloads. Common uses include [cmd](https://attack.mitre.org/software/S0106) to execute a single command, or abusing [cmd](https://attack.mitre.org/software/S0106) interactively with input and output forwarded over a command and control channel.", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Windows Command Shell - T1059.003\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1059.003"}]}, {"type": "attack-pattern", "id": "attack-pattern--2959d63f-73fd-46a1-abd2-109d7dcede32", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Windows Service - T1543.003", "description": "ATT&CK Tactic | Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions.(Citation: TechNet Services) Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry.\n\nAdversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API. \n\nAdversaries may also use services to install and execute malicious drivers. For example, after dropping a driver file (ex: `.sys`) to disk, the payload can be loaded and registered via [Native API](https://attack.mitre.org/techniques/T1106) functions such as `CreateServiceW()` (or manually via functions such as `ZwLoadDriver()` and `ZwSetValueKey()`), by creating the required service Registry values (i.e. [Modify Registry](https://attack.mitre.org/techniques/T1112)), or by using command-line utilities such as `PnPUtil.exe`.(Citation: Symantec W.32 Stuxnet Dossier)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Unit42 AcidBox June 2020) Adversaries may leverage these drivers as [Rootkit](https://attack.mitre.org/techniques/T1014)s to hide the presence of malicious activity on a system. Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as \"Bring Your Own Vulnerable Driver\" (BYOVD)) as part of [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020)\n\nServices may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges. Adversaries may also directly start services through [Service Execution](https://attack.mitre.org/techniques/T1569/002). To make detection analysis more challenging, malicious services may also incorporate [Masquerade Task or Service](https://attack.mitre.org/techniques/T1036/004) (ex: using a service and/or payload name related to a legitimate OS or benign software component).", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Windows Service - T1543.003\""], "external_references": [{"source_name": "capec", "external_id": "CAPEC-551"}]}, {"type": "attack-pattern", "id": "attack-pattern--d13fa042-8f26-44e1-a2a8-af0bf8e2ac9a", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Obfuscated Files or Information - T1406", "description": "ATT&CK Tactic | An app could contain malicious code in obfuscated or encrypted form, then deobfuscate or decrypt the code at runtime to evade many app vetting techniques.(Citation: Rastogi) (Citation: Zhou) (Citation: TrendMicro-Obad) (Citation: Xiao-iOS)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Obfuscated Files or Information - T1406\""], "external_references": [{"source_name": "NIST Mobile Threat Catalogue", "external_id": "APP-21"}]}, {"type": "attack-pattern", "id": "attack-pattern--e4dc8c01-417f-458d-9ee0-bb0617c1b391", "created": "2023-03-22T19:07:30.000Z", "modified": "2023-03-22T19:07:30.000Z", "name": "Debugger Evasion - T1622", "description": "ATT&CK Tactic | Adversaries may employ various means to detect and avoid debuggers. Debuggers are typically used by defenders to trace and/or analyze the execution of potential malware payloads.(Citation: ProcessHacker Github)\n\nDebugger evasion may include changing behaviors based on the results of the checks for the presence of artifacts indicative of a debugged environment. Similar to [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497), if the adversary detects a debugger, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for debugger artifacts before dropping secondary or additional payloads.\n\nSpecific checks will vary based on the target and/or adversary, but may involve [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>IsDebuggerPresent()</code> and <code> NtQueryInformationProcess()</code>, or manually checking the <code>BeingDebugged</code> flag of the Process Environment Block (PEB). Other checks for debugging artifacts may also seek to enumerate hardware breakpoints, interrupt assembly opcodes, time checks, or measurements if exceptions are raised in the current process (assuming a present debugger would \u201cswallow\u201d or handle the potential error).(Citation: hasherezade debug)(Citation: AlKhaser Debug)(Citation: vxunderground debug)\n\nAdversaries may use the information learned from these debugger checks during automated discovery to shape follow-on behaviors. Debuggers can also be evaded by detaching the process or flooding debug logs with meaningless data via messages produced by looping [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>OutputDebugStringW()</code>.(Citation: wardle evilquest partii)(Citation: Checkpoint Dridex Jan 2021)", "kill_chain_phases": [{"kill_chain_name": "misp-category", "phase_name": "mitre-attack-pattern"}], "labels": ["misp:galaxy-name=\"Attack Pattern\"", "misp:galaxy-type=\"mitre-attack-pattern\"", "misp-galaxy:mitre-attack-pattern=\"Debugger Evasion - T1622\""], "external_references": [{"source_name": "mitre-attack", "external_id": "T1622"}]}, {"type": "marking-definition", "id": "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "created": "2017-01-20T00:00:00.000Z", "definition_type": "tlp", "definition": {"tlp": "white"}}]}
